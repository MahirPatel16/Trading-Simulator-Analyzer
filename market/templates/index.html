<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../static/css/style_index.css" />
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    {% block head %} 
    
    {% endblock %}
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}TRADE BREEZERS {% endblock %}</title>

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> -->
  </head>
  <body>
    <header>
      <nav>
        <div class="navbar">
          <div class="left-column">
            <div class="image">
              <img
                src="../static/images/logo.png"
                alt="logo"
                width="40px"
                height="40px"
              />
            </div>
            <a href="/" class="brand">TRADE BREEZERS</a>
            <div class="nav-links">
              <a href="/home">Home</a>
              <a href="/market">Market</a>
              <!-- <a href="#">Yesterday Market</a> -->
              <a href="#">Contact Us</a>
            </div>
          </div>

          <div class="right-container nav-links">
            <a href="#">About Us</a>
            <a href="/login">Log Out</a>
          </div>
        </div>
      </nav>
    </header>
    <div class="graph-container">
      <div class="grid-items" id="griditem1"></div>
      <div class="grid-items news-container" id="griditem2">
        <h2>Business News</h2>
        <ul id="news-list"></ul>
      </div>
      <div class="grid-items" id="griditem3"></div>
      <div class="grid-items form-section" id="griditem4">
        <form action="/graph" method="post" id="stock-form">
          <!-- <label for="stock_symbol">Stock Symbol:</label>
          <input type="text" id="stock_symbol" name="stock_symbol" required /> -->
          <label for="stock_symbol">Stock Symbols (comma-separated):</label>
          <input type="text" id="stock_symbol" name="stock_symbol" required />

          <label for="duration">Select Duration:</label>
          <select id="duration" name="duration">
            <option value="1w">1 Week</option>
            <option value="1m">1 Month</option>
            <option value="6m">6 Months</option>
            <option value="1y">1 Year</option>
            <option value="5y">5 Years</option>
          </select>

          <label for="additional_stock">Add Another Stock:</label>
          <input type="text" id="additional_stock" name="additional_stock" />
          <button type="button" id="add-stock-button">Add Another Stock</button>

          <button type="button" id="show-graph-button">Show Graph</button>
        </form>
      </div>
    </div>
    {% block content %} {% endblock %}
    <footer>
      <p>&copy; 2024 Stock Graphs</p>
    </footer>
    <script>
      $(document).ready(function () {
        // Function to fetch and display news
        function fetchNews() {
          $.ajax({
            type: "GET",
            url: "/get_news",
            success: function (response) {
              displayNews(response);
            },
          });
        }

        // Function to display limited news on the webpage
        function displayNews(news) {
          var newsList = $("#news-list");
          newsList.empty();

          // Limit the number of headlines to display
          var maxHeadlines = 5;
          for (var i = 0; i < Math.min(news.length, maxHeadlines); i++) {
            var article = news[i];
            var listItem = $("<li>");
            listItem.html(
              `<a href="${article.url}" target="_blank">${article.title}</a>`
            );
            newsList.append(listItem);
          }
        }

        // Fetch news when the document is ready
        fetchNews();
        $("#stock-form").submit(function (event) {
          event.preventDefault(); // Prevent the default form submission behavior

          $.ajax({
            type: "POST",
            url: "/graph",
            data: $("#stock-form").serialize(),
            success: function (response) {
              $("#griditem3").html(response);
            },
          });
        });

        // Alternatively, you can handle the button click separately
        $("#stock-form button").on("click", function () {
          $("#stock-form").submit(); // Trigger the form submission when the button is clicked
        });
        
      });
    </script>
  </body>
</html>
